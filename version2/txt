Here is the second version of the code
